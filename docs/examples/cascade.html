<!DOCTYPE html>
<html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<head>
  <title>demo of cascading graph</title>
<style>
  html, body {
    font-family: sans-serif;
    background-color:#ffffff;
    margin:0;
    padding:0;
  }
  .graphfellow {
    width: 100%;
    height:96vh;
    overflow:hidden;
  }
  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.0/pixi.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
<script src="../../graphfellow.js"></script>
</head>
<body>
<div class="graphfellow" data-graph-src="cascade.json" ></div>
<script>

  GraphFellow.add_function("drop_new_marble", function(event, graph){
    let v = graph.get_vertex_by_id("00");
    v.payload.set(v.payload.value+1);
    v.pulse(event.type == 'pointertap' ? 0x00ff00 : 0x0000ff);
    let t = graph.create_traveller({"at_vertex": v});
    t.travel(v.get_random_edge_out());
  });

  GraphFellow.add_function("marble_arrives", function(event, graph){
    let t = this;
    t.at_vertex.payload.set(t.at_vertex.payload.value+1);
    if (t.at_vertex.id.indexOf("6") === 0) { // bottom (6th) row
      t.destroy();
      t.at_vertex.pulse();
    } else {
      setTimeout(function(){t.travel(t.at_vertex.get_random_edge_out())}, 10);
    }
  });
  GraphFellow.init();
</script>
</body>
</html>